<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>News Query ‚Äì Fact-Checked News</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg-main: #050816;
      --bg-panel: #0d1221;
      --bg-card: #141a2f;
      --bg-card-alt: #12172a;
      --accent: #4f9cff;
      --accent-soft: rgba(79, 156, 255, 0.22);
      --text-main: #f5f7ff;
      --text-muted: #9ca4c8;
      --border-soft: #232842;

      --badge-world: #4f9cff;
      --badge-tech: #8e7bff;
      --badge-business: #00c897;
      --badge-science: #ffa63b;
      --badge-health: #ff5c7c;
      --badge-politics: #f1c40f;

      --cred-verified: #2ecc71;
      --cred-mixed: #f1c40f;
      --cred-unverified: #7f8c8d;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: radial-gradient(circle at top, #101632 0, #050816 55%);
      color: var(--text-main);
      min-height: 100vh;
    }

    .page {
      max-width: 1200px;
      margin: 0 auto;
      padding: 24px 16px 40px;
    }

    /* HERO */

    .hero {
      text-align: center;
      padding: 40px 12px 36px;
    }

    .hero-icon {
      width: 56px;
      height: 56px;
      border-radius: 20px;
      margin: 0 auto 14px;
      background: radial-gradient(circle at 30% 0, #7b5cff, #4f9cff);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
    }

    .hero-title {
      font-size: 32px;
      letter-spacing: -0.04em;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .hero-subtitle {
      max-width: 640px;
      margin: 0 auto;
      font-size: 14px;
      line-height: 1.6;
      color: var(--text-muted);
    }

    .hero-divider {
      width: 80px;
      height: 2px;
      border-radius: 999px;
      background: linear-gradient(90deg, transparent, #4f9cff, transparent);
      margin: 18px auto 0;
      opacity: 0.9;
    }

    /* TOP SEARCH BAR */

    .top-bar {
      background: var(--bg-panel);
      border-radius: 16px;
      border: 1px solid var(--border-soft);
      padding: 16px 18px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .top-bar-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      font-size: 13px;
    }

    .top-brand {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .top-brand-title {
      font-weight: 500;
    }

    .top-brand-subtitle {
      color: var(--text-muted);
      font-size: 12px;
    }

    .top-saved {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .top-saved-icon {
      width: 18px;
      height: 18px;
      border-radius: 6px;
      border: 1px solid var(--border-soft);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .search-row {
      display: flex;
      gap: 10px;
      margin-top: 4px;
      flex-wrap: wrap;
    }

    .select-topic {
      min-width: 130px;
      background: var(--bg-card);
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      color: var(--text-main);
      font-size: 13px;
      padding: 8px 12px;
    }

    .search-input-wrap {
      flex: 1;
      min-width: 160px;
      position: relative;
    }

    .search-input {
      width: 100%;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      background: #050816;
      color: var(--text-main);
      padding: 9px 38px 9px 14px;
      font-size: 13px;
    }

    .search-input::placeholder {
      color: #5e6687;
    }

    .search-icon {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 16px;
      opacity: 0.7;
    }

    .search-button {
      border-radius: 999px;
      border: none;
      background: linear-gradient(135deg, #4f9cff, #2f6cff);
      padding: 9px 18px;
      color: #ffffff;
      font-size: 13px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      white-space: nowrap;
    }

    /* MAIN LAYOUT */

    .main-layout {
      display: grid;
      grid-template-columns: 260px minmax(0, 1fr);
      gap: 20px;
      margin-top: 20px;
    }

    @media (max-width: 900px) {
      .main-layout {
        grid-template-columns: 1fr;
      }
    }

    /* FILTERS SIDEBAR */

    .filters-panel {
      background: var(--bg-panel);
      border-radius: 16px;
      border: 1px solid var(--border-soft);
      padding: 16px 16px 14px;
      font-size: 13px;
    }

    .filters-title {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      margin-bottom: 12px;
    }

    .filters-icon {
      width: 18px;
      height: 18px;
      border-radius: 999px;
      background: var(--accent-soft);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      color: var(--accent);
    }

    .filters-group {
      margin-bottom: 14px;
    }

    .filters-group-label {
      font-size: 12px;
      font-weight: 500;
      margin-bottom: 6px;
      color: var(--text-muted);
    }

    .checkbox-row {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 4px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .checkbox-row input {
      accent-color: var(--accent);
    }

    .filters-select {
      width: 100%;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      background: var(--bg-card);
      color: var(--text-main);
      font-size: 12px;
      padding: 7px 10px;
    }

    .filters-note {
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 6px;
    }

    /* CONTENT AREA */

    .content-panel {
      background: var(--bg-panel);
      border-radius: 16px;
      border: 1px solid var(--border-soft);
      padding: 16px 16px 20px;
    }

    .content-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 12px;
    }

    .content-title {
      font-size: 15px;
      font-weight: 500;
    }

    .content-subtitle {
      font-size: 12px;
      color: var(--text-muted);
    }

    .content-status {
      font-size: 11px;
      color: var(--text-muted);
    }

    /* CARDS GRID */

    .cards-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 14px;
    }

    @media (max-width: 1050px) {
      .cards-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (max-width: 650px) {
      .cards-grid {
        grid-template-columns: 1fr;
      }
    }

  .card {
  background: var(--bg-card);
  border-radius: 16px;
  /* allow tooltip to extend outside the card */
  overflow: visible;
  border: 1px solid #1f2540;
  display: flex;
  flex-direction: column;
  min-height: 230px;
  position: relative; /* helps z-index if needed later */
}

    .card-img {
  height: 160px;
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-color: var(--bg-card-alt);
  border-radius: 16px 16px 0 0; /* keep top corners rounded */
  overflow: hidden;             /* clip image inside its own box */
}

    .card-body {
      padding: 10px 12px 12px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      flex: 1;
    }

    .card-top-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-bottom: 4px;
    }

    .topic-pill {
      border-radius: 999px;
      padding: 3px 8px;
      font-size: 11px;
      font-weight: 500;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    .topic-world { color: var(--badge-world); }
    .topic-tech { color: var(--badge-tech); }
    .topic-business { color: var(--badge-business); }
    .topic-science { color: var(--badge-science); }
    .topic-health { color: var(--badge-health); }
    .topic-politics { color: var(--badge-politics); }

    .fact-badge {
      border-radius: 999px;
      padding: 3px 8px;
      font-size: 11px;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
      position: relative;      /* for tooltip */
      cursor: help;            /* indicate more info */
    }

    .fact-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #ffffff;
      opacity: 0.9;
    }

    .fact-verified {
      background: rgba(46, 204, 113, 0.15);
      color: var(--cred-verified);
      border: 1px solid rgba(46, 204, 113, 0.5);
    }

    .fact-mixed {
      background: rgba(241, 196, 15, 0.15);
      color: var(--cred-mixed);
      border: 1px solid rgba(241, 196, 15, 0.5);
    }

    .fact-unverified {
      background: rgba(127, 140, 141, 0.15);
      color: var(--cred-unverified);
      border: 1px solid rgba(127, 140, 141, 0.5);
    }

    /* Tooltip styles */
    .cred-tooltip {
      position: absolute;
      bottom: 140%;
      left: 50%;
      transform: translateX(-50%) translateY(6px);
      background: #050816;
      border-radius: 8px;
      border: 1px solid var(--border-soft);
      padding: 6px 8px;
      font-size: 11px;
      color: var(--text-main);
        width: 190px;
  max-width: 90vw;
  line-height: 1.4;
  word-wrap: break-word;
      line-height: 1.4;
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.4);
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
      transition: opacity 0.16s ease-out,
                  transform 0.16s ease-out,
                  visibility 0.16s ease-out;
      z-index: 10;
    }

    .cred-tooltip::after {
      content: "";
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      border-width: 6px;
      border-style: solid;
      border-color: #050816 transparent transparent transparent;
    }

    .fact-badge:hover .cred-tooltip,
    .fact-badge.is-open .cred-tooltip {
      opacity: 1;
      visibility: visible;
      pointer-events: auto;
      transform: translateX(-50%) translateY(0);
    }

    .card-title {
      font-size: 14px;
      font-weight: 500;
      line-height: 1.35;
    }

    .card-text {
      font-size: 12px;
      color: var(--text-muted);
      line-height: 1.4;
    }

    .card-meta-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 4px;
    }

    .card-footer {
      margin-top: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      font-size: 12px;
    }

    .btn-read {
      flex: 1;
      border-radius: 999px;
      border: none;
      padding: 7px 0;
      background: #f5f7ff;
      color: #101632;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
    }

    .bookmark-btn {
      width: 30px;
      height: 30px;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      background: transparent;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: default;
      color: var(--text-muted);
      font-size: 15px;
    }

    .empty-state {
      font-size: 12px;
      color: var(--text-muted);
      padding: 8px 2px;
    }

    footer {
      margin-top: 18px;
      font-size: 11px;
      color: var(--text-muted);
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="page">
    <!-- HERO -->
    <section class="hero">
      <div class="hero-icon">‚ú¶</div>
      <h1 class="hero-title">News Query</h1>
      <p class="hero-subtitle">
        Pull headlines from the New York Times, enrich each with fact-check status.
        Browse, search, and filter stories in one place.
      </p>
      <div class="hero-divider"></div>
    </section>

    <!-- TOP SEARCH BAR -->
    <section class="top-bar">
      <div class="top-bar-head">
        <div class="top-brand">
          <span class="top-brand-title">News Query</span>
          <span class="top-brand-subtitle">Fact-Checked News from NYT + Google</span>
        </div>
        <div class="top-saved">
          <div class="top-saved-icon">üîñ</div>
          <span>Saved</span>
        </div>
      </div>

      <form id="searchForm" class="search-row">
        <select id="topicSelect" class="select-topic">
          <option value="all">All topics</option>
          <option value="world">World</option>
          <option value="technology">Tech</option>
          <option value="business">Business</option>
          <option value="science">Science</option>
          <option value="health">Health</option>
          <option value="politics">Politics</option>
        </select>

        <div class="search-input-wrap">
          <input
            id="keywordInput"
            class="search-input"
            type="text"
            placeholder="Enter keywords‚Ä¶"
          />
          <span class="search-icon">üîç</span>
        </div>

        <button id="searchButton" class="search-button" type="submit">
          Search
        </button>
      </form>
    </section>

    <!-- MAIN LAYOUT -->
    <section class="main-layout">
      <!-- FILTERS SIDEBAR -->
      <aside class="filters-panel">
        <div class="filters-title">
          <div class="filters-icon">‚ò∞</div>
          <span>Filters</span>
        </div>

        <div class="filters-group">
          <div class="filters-group-label">Topic</div>
          <label class="checkbox-row">
            <input type="checkbox" class="topic-filter" value="world" checked />
            <span>World</span>
          </label>
          <label class="checkbox-row">
            <input type="checkbox" class="topic-filter" value="technology" checked />
            <span>Tech</span>
          </label>
          <label class="checkbox-row">
            <input type="checkbox" class="topic-filter" value="business" checked />
            <span>Business</span>
          </label>
          <label class="checkbox-row">
            <input type="checkbox" class="topic-filter" value="science" checked />
            <span>Science</span>
          </label>
          <label class="checkbox-row">
            <input type="checkbox" class="topic-filter" value="health" checked />
            <span>Health</span>
          </label>
          <label class="checkbox-row">
            <input type="checkbox" class="topic-filter" value="politics" checked />
            <span>Politics</span>
          </label>
        </div>

        <div class="filters-group">
          <div class="filters-group-label">Date Range</div>
          <select id="dateRangeSelect" class="filters-select">
            <option value="all">All time</option>
            <option value="7">Last 7 days</option>
            <option value="30">Last 30 days</option>
          </select>
        </div>

        <div class="filters-group">
          <div class="filters-group-label">Credibility Status</div>
          <label class="checkbox-row">
            <input type="checkbox" class="cred-filter" value="verified" checked />
            <span>Verified</span>
          </label>
          <label class="checkbox-row">
            <input type="checkbox" class="cred-filter" value="mixed" checked />
            <span>Mixed</span>
          </label>
          <label class="checkbox-row">
            <input type="checkbox" class="cred-filter" value="unverified" checked />
            <span>Unverified</span>
          </label>
        </div>

        <div class="filters-note">
          Filters run on the 9 demo articles loaded below.
        </div>
      </aside>

      <!-- CONTENT -->
      <section class="content-panel">
        <div class="content-header">
          <div>
            <div class="content-title">Latest News</div>
            <div id="articlesCount" class="content-subtitle">
              0 articles found.
            </div>
          </div>
          <div id="statusText" class="content-status">Status: ready</div>
        </div>

        <div id="cardsGrid" class="cards-grid">
          <!-- Cards rendered here -->
        </div>

        <div class="empty-state" id="emptyState" style="display:none;">
          No articles match your filters.
        </div>
      </section>
    </section>

    <footer>
      Viktor Danilkovych | IMA | Front End Web
    </footer>
  </div>

  <script>
    // ===== 1. Demo data ‚Äì 9 posts =====
    const allArticles = [
      {
        id: 1,
        title: "Disney and OpenAI Strike Sora Deal for New AI-Powered Entertainment",
        abstract:
          "Disney has reached a strategic agreement with OpenAI to use its Sora generative AI in future films, series and experiences, blending the studio‚Äôs content library with advanced AI tools.",
        topic: "business",
        date: "2025-12-11",
        url: "https://www.nytimes.com/2025/12/11/business/media/disney-openai-sora-deal.html",
        credibility: "verified",
        image: "image1.webp",
        keywords: ["disney", "openai", "sora", "ai", "entertainment", "media deal"]
      },
      {
        id: 2,
        title: "Live Updates: The Latest Developments in Trump News",
        abstract:
          "A live New York Times page tracks new legal moves, political reactions and statements from Donald Trump and his allies, updating throughout the day as events unfold.",
        topic: "politics",
        date: "2025-12-11",
        url: "https://www.nytimes.com/live/2025/12/11/us/trump-news",
        credibility: "mixed",
        image: "image2.webp",
        keywords: ["trump", "live updates", "us politics", "elections", "legal news"]
      },
      {
        id: 3,
        title: "Rising Beef Prices Put Pressure on Steakhouses and Diners",
        abstract:
          "Wholesale beef costs have climbed sharply, forcing steakhouses to raise menu prices, shrink portions or swap cuts as they fight to keep regulars coming back.",
        topic: "business",
        date: "2025-12-10",
        url: "https://www.nytimes.com/2025/12/10/business/beef-prices-steakhouses.html",
        credibility: "verified",
        image: "image3.webp",
        keywords: ["beef prices", "steakhouses", "restaurants", "inflation", "food costs"]
      },
      {
        id: 4,
        title: "USAID Backs Mosquito Project in New Push Against Malaria",
        abstract:
          "A new USAID program supports scientists using lab-bred mosquitoes and other tools to cut malaria transmission, raising hopes for progress against one of the world‚Äôs deadliest diseases.",
        topic: "health",
        date: "2025-12-11",
        url: "https://www.nytimes.com/2025/12/11/science/malaria-usaid-mosquitoes.html",
        credibility: "verified",
        image: "image4.webp",
        keywords: ["malaria", "usaid", "mosquitoes", "global health", "disease control"]
      },
      {
        id: 5,
        title: "A Science Study Revisits Shackleton‚Äôs Endurance and Human Limits",
        abstract:
          "Researchers look back at Ernest Shackleton‚Äôs Endurance expedition to understand how extreme cold, isolation and stress shaped the crew‚Äôs bodies and minds.",
        topic: "science",
        date: "2025-12-11",
        url: "https://www.nytimes.com/2025/12/11/learning/science-practice-a-study-on-shackletons-endurance.html",
        credibility: "verified",
        image: "image5.webp",
        keywords: ["shackleton", "endurance", "antarctica", "human limits", "science study"]
      },
      {
        id: 6,
        title: "OpenAI Pulls Ahead as Google Struggles to Close AI Technology Gap",
        abstract:
          "Industry analysts say OpenAI‚Äôs recent model releases and tools have widened the distance with Google, intensifying the race for talent, cloud customers and developer mindshare.",
        topic: "technology",
        date: "2025-12-11",
        url: "https://www.nytimes.com/2025/12/11/technology/openai-google-ai-technology-gap.html",
        credibility: "mixed",
        image: "image6.webp",
        keywords: ["openai", "google", "ai race", "language models", "tech competition"]
      },
      {
        id: 7,
        title: "U.A.E. Turns to Open-Source AI to Build Its Own Tech Future",
        abstract:
          "The United Arab Emirates is investing heavily in open-source AI models, hoping to reduce dependence on U.S. tech giants and position itself as a regional hub for artificial intelligence.",
        topic: "technology",
        date: "2025-09-09",
        url: "https://www.nytimes.com/2025/09/09/technology/uae-emirates-ai-open-source.html",
        credibility: "verified",
        image: "image7.webp",
        keywords: ["uae", "open-source ai", "emirates", "technology policy", "global ai"]
      },
      {
        id: 8,
        title: "Trump‚Äôs Executive Orders Seek Tighter Rules for Artificial Intelligence",
        abstract:
          "Executive orders signed by Donald Trump outline new federal priorities on AI safety, data use and government adoption, drawing mixed reactions from tech firms and civil liberties groups.",
        topic: "politics",
        date: "2025-07-23",
        url: "https://www.nytimes.com/2025/07/23/technology/trump-ai-executive-orders.html",
        credibility: "mixed",
        image: "image8.webp",
        keywords: ["trump", "executive orders", "ai regulation", "tech policy", "government"]
      },
      {
        id: 9,
        title: "Trump Criticizes Biden Over Venezuela Tanker Dispute",
        abstract:
          "Donald Trump has attacked the Biden administration‚Äôs handling of a Venezuelan oil tanker case, turning a diplomatic dispute into a fresh flash point in U.S. domestic politics.",
        topic: "politics",
        date: "2025-12-11",
        url: "https://www.nytimes.com/2025/12/11/us/politics/trump-venezuela-tanker.html",
        credibility: "mixed",
        image: "image9.webp",
        keywords: ["trump", "venezuela", "tanker", "foreign policy", "us politics"]
      }
    ];

    // Short explanations for credibility labels
    const credibilityExplanations = {
      verified:
        "Verified: Key claims in this article align with reporting from reliable sources or fact-checkers.",
      mixed:
        "Mixed: Some claims are supported by reliable sources while others are disputed or unclear.",
      unverified:
        "Unverified: Key claims have not yet been evaluated by major fact-checking sources."
    };

    // ===== 2. DOM refs =====
    const searchForm = document.getElementById("searchForm");
    const topicSelect = document.getElementById("topicSelect");
    const keywordInput = document.getElementById("keywordInput");
    const dateRangeSelect = document.getElementById("dateRangeSelect");
    const topicFilters = document.querySelectorAll(".topic-filter");
    const credFilters = document.querySelectorAll(".cred-filter");
    const cardsGrid = document.getElementById("cardsGrid");
    const articlesCountEl = document.getElementById("articlesCount");
    const statusText = document.getElementById("statusText");
    const emptyState = document.getElementById("emptyState");

    const topicClassMap = {
      world: "topic-world",
      technology: "topic-tech",
      business: "topic-business",
      science: "topic-science",
      health: "topic-health",
      politics: "topic-politics"
    };

    function setStatus(text) {
      statusText.textContent = "Status: " + text;
    }

    function formatDate(dateStr) {
      const d = new Date(dateStr);
      if (isNaN(d.getTime())) return "";
      return d.toLocaleDateString(undefined, {
        year: "numeric",
        month: "short",
        day: "numeric"
      });
    }

    function daysAgo(dateStr) {
      const d = new Date(dateStr);
      const now = new Date();
      const diffMs = now - d;
      return diffMs / (1000 * 60 * 60 * 24);
    }

    // ===== 3. Filtering logic =====
    function applyFilters() {
      const keyword = keywordInput.value.trim().toLowerCase();
      const topTopic = topicSelect.value; // from dropdown
      const dateRange = dateRangeSelect.value;

      const activeSideTopics = Array.from(topicFilters)
        .filter(cb => cb.checked)
        .map(cb => cb.value);

      const activeCreds = Array.from(credFilters)
        .filter(cb => cb.checked)
        .map(cb => cb.value);

      const filtered = allArticles.filter(article => {
        // keyword match (title + abstract + keywords)
        const text =
          (article.title + " " + article.abstract + " " + article.keywords.join(" "))
            .toLowerCase();
        const matchesKeyword = keyword === "" || text.includes(keyword);

        // topic from top select
        const matchesTopTopic =
          topTopic === "all" || article.topic === topTopic;

        // topic from sidebar checkboxes
        const matchesSideTopic =
          activeSideTopics.length === 0 ||
          activeSideTopics.includes(article.topic);

        // credibility filters
        const matchesCred =
          activeCreds.length === 0 ||
          activeCreds.includes(article.credibility);

        // date range
        let matchesDate = true;
        if (dateRange !== "all") {
          const limit = Number(dateRange);
          matchesDate = daysAgo(article.date) <= limit;
        }

        return (
          matchesKeyword &&
          matchesTopTopic &&
          matchesSideTopic &&
          matchesCred &&
          matchesDate
        );
      });

      renderCards(filtered);
    }

    // ===== 4. Rendering =====
    function renderCards(articles) {
      cardsGrid.innerHTML = "";

      articlesCountEl.textContent =
        articles.length === 1
          ? "1 article found."
          : `${articles.length} articles found.`;

      emptyState.style.display = articles.length === 0 ? "block" : "none";
      if (articles.length === 0) return;

      articles.forEach(article => {
        const card = document.createElement("article");
        card.className = "card";

        const imgDiv = document.createElement("div");
        imgDiv.className = "card-img";
        imgDiv.style.backgroundImage = `url("${article.image}")`;
        card.appendChild(imgDiv);

        const body = document.createElement("div");
        body.className = "card-body";

        const topRow = document.createElement("div");
        topRow.className = "card-top-row";

        const topicSpan = document.createElement("span");
        topicSpan.className = "topic-pill";
        const topicKey = article.topic;
        if (topicClassMap[topicKey]) {
          topicSpan.classList.add(topicClassMap[topicKey]);
        }
        topicSpan.textContent =
          topicKey.charAt(0).toUpperCase() + topicKey.slice(1);

        const fb = document.createElement("span");
        fb.className = "fact-badge";
        if (article.credibility === "verified") {
          fb.classList.add("fact-verified");
        } else if (article.credibility === "mixed") {
          fb.classList.add("fact-mixed");
        } else {
          fb.classList.add("fact-unverified");
        }

        const dot = document.createElement("span");
        dot.className = "fact-dot";
        const fbText = document.createElement("span");
        fbText.textContent =
          article.credibility === "verified"
            ? "Verified"
            : article.credibility === "mixed"
            ? "Mixed"
            : "Unverified";

        // Tooltip content
        const tooltip = document.createElement("span");
        tooltip.className = "cred-tooltip";
        tooltip.textContent =
          credibilityExplanations[article.credibility] ||
          "Credibility rating for this article in this demo.";

        fb.appendChild(dot);
        fb.appendChild(fbText);
        fb.appendChild(tooltip);

        topRow.appendChild(topicSpan);
        topRow.appendChild(fb);

        const titleEl = document.createElement("div");
        titleEl.className = "card-title";
        titleEl.textContent = article.title;

        const textEl = document.createElement("div");
        textEl.className = "card-text";
        textEl.textContent = article.abstract;

        const metaRow = document.createElement("div");
        metaRow.className = "card-meta-row";
        const src = document.createElement("span");
        src.textContent = "New York Times";
        const date = document.createElement("span");
        date.textContent = formatDate(article.date);
        metaRow.appendChild(src);
        metaRow.appendChild(date);

        const footer = document.createElement("div");
        footer.className = "card-footer";
        const readBtn = document.createElement("button");
        readBtn.className = "btn-read";
        readBtn.textContent = "Read on NYT";
        readBtn.onclick = () => {
          window.open(article.url, "_blank");
        };

        const bmBtn = document.createElement("button");
        bmBtn.className = "bookmark-btn";
        bmBtn.innerHTML = "üîñ";

        footer.appendChild(readBtn);
        footer.appendChild(bmBtn);

        body.appendChild(topRow);
        body.appendChild(titleEl);
        body.appendChild(textEl);
        body.appendChild(metaRow);
        body.appendChild(footer);

        card.appendChild(body);
        cardsGrid.appendChild(card);

        // Click-to-open for mobile: toggle .is-open on this badge
        fb.addEventListener("click", function (event) {
          event.stopPropagation();
          const isOpen = fb.classList.contains("is-open");
          document
            .querySelectorAll(".fact-badge.is-open")
            .forEach(el => el.classList.remove("is-open"));
          if (!isOpen) {
            fb.classList.add("is-open");
          }
        });
      });
    }

    // Close any open tooltip when clicking elsewhere
    document.addEventListener("click", () => {
      document
        .querySelectorAll(".fact-badge.is-open")
        .forEach(el => el.classList.remove("is-open"));
    });

    // ===== 5. Events =====
    searchForm.addEventListener("submit", function (e) {
      e.preventDefault();
      applyFilters();
    });

    dateRangeSelect.addEventListener("change", applyFilters);
    topicSelect.addEventListener("change", applyFilters);
    topicFilters.forEach(cb => cb.addEventListener("change", applyFilters));
    credFilters.forEach(cb => cb.addEventListener("change", applyFilters));

    // Initial render
    setStatus("ready (demo data)");
    renderCards(allArticles);
  </script>
</body>
</html>
